{% extends "layout.html" %}
{% block body %}
	<form action="start" method=get class=add-entry onsubmit="return validateForm()">
	      <dl>
					<dd>URL:<input type=url name=site size="70" placeholder="Input Url">

					<p>Select Applicable Genre:</p>

					<!-- select genre id	<tab -->
					<table >

						<tr>

							<td>
								<input type="radio" onclick="checkGenre()"name="genre"
								 id="Shop" value="Shop" > Shop
							</td>

							<td>
								<input type="radio" onclick="checkGenre()"name="genre"
								 id="Help/Discussion" value="Help/Discussion" > Help
							</td>

							<td>
								<input type="radio" onclick="checkGenre()"name="genre"
								 id="Portrayl-Individual" value="Portrayl-Individual" > Portrayl-Individual
							</td>

							<td>
								<input type="radio" onclick="checkGenre()"name="genre"
								 id="Articles" value="Articles" > Articles
							</td>

							<td>
								
								<input type="radio" onclick="checkGenre()"name="genre"
								 id="other-genre" value="other" >
								 <input type='text' placeholder="Other Genre"
									 name="other-genre"/>
							</td>

						</tr>

					</table>

					<hr>
					<div id="tool" style="display:none">

						<!-- select dimension -->
						<table cellpadding="10px" id="dimensions">

							<tr>

								<td>
									<input type="checkbox" name="ads" id="ads" value="true" >
									 Advertisement
									<br>
									<input type="number" step="any" min="0" max="100" \
										name="adsPerc" id="adsPerc" value="0">
								</td>

								<td>
									<input type="checkbox" name="brokenlinks" id="brokenlinks"
									value="true" > Broken Links
									<br>
									<input type="number" step="any" min="0" max="100" \
										name="brokenlinksPerc" id="brokenlinksPerc" value="0">
								</td>

								<td>
									<input type="checkbox" name="langcount" id="langcount"
									value="true" > Internationalization
									<br>
									<input type="number" step="any" min="0" max="100" \
										name="langcountPerc" id="langcountPerc" value="0">
								</td>

								<!-- <td>
									<input type="checkbox" name="genre" id="genre" value="true" > Genre
								</td> -->

								<!-- <td>
									<input type="checkbox" name="cohesion" id="cohesion" value="true" > Cohesion
								</td> -->

								<!-- <td>
									<input type="checkbox" name="domain_similarity"
									id="domain_similarity" value="true" > Domain Similarity
								</td> -->

						  </tr>

							<tr>

								<td>
									<input type="checkbox" name="domain" id="domain" value="true" > Internet Domain
									<br>
									<input type="number" step="any" min="0" max="100" \
										name="domainPerc" id="domainPerc" value="0">
								</td>

								<td>
									<input type="checkbox" name="inlinks" id="inlinks" value="true" > Inlinks
									<br>
									<input type="number" step="any" min="0" max="100" \
										name="inlinksPerc" id="inlinksPerc" value="0">
								</td>

								<td>
									<input type="checkbox" name="lastmod" id="lastmod" value="true" > Modified Date Time
									<br>
									<input type="number" step="any" min="0" max="100" \
										name="lastmodPerc" id="lastmodPerc" value="0">
								</td>

							</tr>

							<tr>

								<td>
									<input type="checkbox" name="hyperlinks" id="hyperlinks" value="true" > Real World Presence
									<br>
									<input type="number" step="any" min="0" max="100" \
										name="hyperlinksPerc" id="hyperlinksPerc" value="0">
								</td>

								<td>
									<input type="checkbox" name="outlinks" id="outlinks" value="true" >  Outlinks
									<br>
									<input type="number" step="any" min="0" max="100" \
										name="outlinksPerc" id="outlinksPerc" value="0">
								</td>

								<td>
									<input type="checkbox" name="misspelled" id="misspelled" value="true" > Misspell
									<br>
									<input type="number" step="any" min="0" max="100" \
										name="misspelledPerc" id="misspelledPerc" value="0">
								</td>

							</tr>

							<tr>

								<td>
									<input type="checkbox" name="imgratio" id="imgratio" value="true" > Text to Image Ratio
									<br>
									<input type="number" step="any" min="0" max="100" \
										name="imgratioPerc" id="imgratioPerc" value="0">
								</td>

								<td>
									<input type="checkbox" name="responsive" id="responsive" value="true" > Responsive Design
									<br>
									<input type="number" step="any" min="0" max="100" \
										name="responsivePerc" id="responsivePerc" value="0">
								</td>

								<td>
									<input type="checkbox" name="pageloadtime" id="pageloadtime" value="true" > Page Load Time
									<br>
									<input type="number" step="any" min="0" max="100" \
										name="pageloadtimePerc" id="pageloadtimePerc" value="0">
								</td>

							</tr>

						</table>

						<table>
							<tr>

								<td>
									<!-- Add more dimensions -->
									<button type="button" onclick="addRow()">Add more
										Dimensions</button>
								</td>

								<td>
									<!-- Remove last row/dimensions -->
									<button type="button" id="removerow" onclick="removeRow()"
										style="display:none">Remove Last Row</button>
								</td>

							</tr>

						</table>

						<hr>
						<!-- google Captcha -->
						<div class="g-recaptcha" data-sitekey=
							"6LcsiCoUAAAAAM4y5pKsPEGfBasVYdkB0PvgpllL"></div>

						<input type=submit value="Assess Credibility">

					</div>
	      </dl>
	</form>

	<script>
	  function addRow() {
				document.getElementById("removerow").style.display = "inline"
				var x = document.getElementById('dimensions');
			  var new_row = x.rows[1].cloneNode(true);
				//FIXME +5 is caluclated number as total dimensions are 12
				//and len==8
				//HACK if +5 number is changed, then change in utils.py, validateForm()
				// , removeRow()
			  var len = x.rows.length + 9;
				dimension = "dimension" + len;
				api = "api" + len;
				console.log(dimension, api);

			  new_row.cells[0].innerHTML = '<input type="text" placeholder=\
				"New Dimension" name="'+ dimension + '" id="'+dimension+'" required/>';

			  new_row.cells[1].innerHTML = '<input type="url" placeholder=\
				"API for dimension" name="'+ api + '" id="'+api+'"required />';

				// <input type="number" step="any" min="0" max="100" \
				// 	name="imgratioPerc" id="imgratioPerc" value="0">
			  new_row.cells[2].innerHTML = '<input type="number"  placeholder=\
				"Weightage for dimension" step="any" min="0" max="100" name="'+ api +
				'Perc" id="'+api+'Perc" value="0"/>';

			  x.appendChild(new_row);
	  }

		function removeRow(){
			var x = document.getElementById('dimensions');
			rows = x.rows.length;
			if (rows>4){
				x.deleteRow(rows-1);
				if(rows==5){
					document.getElementById("removerow").style.display = "none";
				}
			}
			else{
				alert("No row  to remove");
			}

		}

		function checkGenre(){
			document.getElementById("tool").style.display = ""
			var genre = {}
			genre["Shop"] = {
				'inlinks':"9.09", 'brokenlinks':"9.09", 'domain':"9.09",
				'langcount':"9.09", 'lastmod':"9.09", 'misspelled':"9.09",
				'outlinks':"9.09", 'pageloadtime':"9.09", 'hyperlinks':"9.09",
				'responsive':"9.09", 'imgratio':"9.09"
			};
			genre["Help/Discussion"] = {
				'ads':"14.285", 'inlinks':"14.285", 'domain':"14.285",'langcount':"14.285",
				'lastmod':"14.285",'hyperlinks':"14.285", 'responsive':"14.285",
			};
			genre["Portrayl-Individual"] = {
				'ads':"9.09", 'inlinks':"9.09", 'brokenlinks':"9.09", 'domain':"9.09",
				'lastmod':"9.09", 'misspelled':"9.09",
				'outlinks':"9.09", 'pageloadtime':"9.09", 'hyperlinks':"9.09",
				'responsive':"9.09", 'imgratio':"9.09"
			};
			genre["Articles"] = {
				'ads':"8.33", 'inlinks':"8.33", 'brokenlinks':"8.33", 'domain':"8.33",
				'langcount':"8.33", 'lastmod':"8.33", 'misspelled':"8.33",
				'outlinks':"8.33", 'pageloadtime':"8.33", 'hyperlinks':"8.33",
				'responsive':"8.33", 'imgratio':"8.33"
			};
			genre["other-genre"] = {
				'ads':"8.33", 'inlinks':"8.33", 'brokenlinks':"8.33", 'domain':"8.33",
				'langcount':"8.33", 'lastmod':"8.33", 'misspelled':"8.33",
				'outlinks':"8.33", 'pageloadtime':"8.33", 'hyperlinks':"8.33",
				'responsive':"8.33", 'imgratio':"8.33"
			};
			// REVIEW negative number are not showing
			// genre["other-genre"] = {
			// 	'ads':"−24.0140441", 'inlinks':"−72.8650503", 'brokenlinks':"49.6275523", 'domain':"24.8023672",
			// 	'langcount':"0.8516245", 'lastmod':"50.3201873", 'misspelled':"28.9997645",
			// 	'outlinks':"47.4079554", 'pageloadtime':"−2.2339502", 'hyperlinks':"48.0862371",
			// 	'responsive':"−0.6856424", 'imgratio':"−0.6922669"
			// };

			for(var key in genre){
				if (document.getElementById(key).checked == true){
					// debugger;
					var dimension = genre['other-genre'];

					// reset check and Weightage value
					for(var param in dimension){
						document.getElementById(param).checked = false;
						perc = param+"Perc"
						document.getElementById(perc).value = '0';
					}
					var dimension = genre[key];
					// console.log("checking genre", key, dimension);
					for(var param in dimension){
						document.getElementById(param).checked = true;
						perc = param+"Perc"
						document.getElementById(perc).value = dimension[param];
					}
				}
			}

		}

		function validateForm(){
			var dimensions = [
						'ads', 'inlinks', 'brokenlinks', 'domain',
						'langcount', 'lastmod', 'misspelled',
						'outlinks', 'pageloadtime', 'hyperlinks',
						'responsive', 'imgratio'
					];

			var percentage = 0;

			// summation of Weightage value of dimensions
			for (var j=0; j<dimensions.length; j++){
				param = dimensions[j]
				if(document.getElementById(param).checked==true){
					perc = param + "Perc";
					percentage += parseFloat(document.getElementById(perc).value);
				}
			}

			// summation of Weightage value of added dimensions
			// HACK refer to function addRow()
			number = 13
			while(true){
				dimension = "dimension" + number
				api = "api" + number
				if(document.getElementById(dimension) &&
						document.getElementById(api)){
							perc = api + "Perc"
							percentage += parseFloat(document.getElementById(perc).value);
							number += 1
						}
				else{
					break;
				}
			}

			console.log(percentage)
			// check sum of Weightage
			if(percentage<99.9 || percentage>100.1){
				alert("Sum of Weightage should be 100");
				return false;
			}
		}

	</script>

{% endblock %}
